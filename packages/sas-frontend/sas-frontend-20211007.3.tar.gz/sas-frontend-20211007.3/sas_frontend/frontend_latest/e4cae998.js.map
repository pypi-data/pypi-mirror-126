{"version":3,"file":"e4cae998.js","mappings":";AAsHA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAlBA;;;;;;;;;;;;;;;AA/FA","sources":["webpack://sas-frontend/./src/panels/lovelace/cards/hui-picture-elements-card.ts"],"sourcesContent":["import {\n  css,\n  CSSResultGroup,\n  html,\n  LitElement,\n  PropertyValues,\n  TemplateResult,\n} from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { applyThemesOnElement } from \"../../../common/dom/apply_themes_on_element\";\nimport \"../../../components/ha-card\";\nimport { HomeAssistant } from \"../../../types\";\nimport { findEntities } from \"../common/find-entities\";\nimport { LovelaceElement, LovelaceElementConfig } from \"../elements/types\";\nimport { LovelaceCard } from \"../types\";\nimport { createStyledHuiElement } from \"./picture-elements/create-styled-hui-element\";\nimport { PictureElementsCardConfig } from \"./types\";\n\n@customElement(\"hui-picture-elements-card\")\nclass HuiPictureElementsCard extends LitElement implements LovelaceCard {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @state() private _elements?: LovelaceElement[];\n\n  public static getStubConfig(\n    hass: HomeAssistant,\n    entities: string[],\n    entitiesFallback: string[]\n  ): PictureElementsCardConfig {\n    const maxEntities = 1;\n    const foundEntities = findEntities(\n      hass,\n      maxEntities,\n      entities,\n      entitiesFallback,\n      [\"sensor\", \"binary_sensor\"]\n    );\n\n    return {\n      type: \"picture-elements\",\n      elements: [\n        {\n          type: \"state-badge\",\n          entity: foundEntities[0] || \"\",\n          style: {\n            top: \"32%\",\n            left: \"40%\",\n          },\n        },\n      ],\n      image: \"https://www.smartautomatic.duckdns.org:8091/demo/stub_config/floorplan.png\",\n    };\n  }\n\n  @state() private _config?: PictureElementsCardConfig;\n\n  public getCardSize(): number {\n    return 4;\n  }\n\n  public setConfig(config: PictureElementsCardConfig): void {\n    if (!config) {\n      throw new Error(\"Invalid configuration\");\n    } else if (\n      !(config.image || config.camera_image || config.state_image) ||\n      (config.state_image && !config.entity)\n    ) {\n      throw new Error(\"Image required\");\n    } else if (!Array.isArray(config.elements)) {\n      throw new Error(\"Elements required\");\n    }\n\n    this._config = config;\n\n    this._elements = this._config.elements.map(\n      (elementConfig: LovelaceElementConfig) => {\n        const element = createStyledHuiElement(elementConfig);\n        if (this.hass) {\n          element.hass = this.hass;\n        }\n        return element as LovelaceElement;\n      }\n    );\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (!this._config || !this.hass) {\n      return;\n    }\n\n    if (this._elements && changedProps.has(\"hass\")) {\n      for (const element of this._elements) {\n        element.hass = this.hass;\n      }\n    }\n\n    const oldHass = changedProps.get(\"hass\") as HomeAssistant | undefined;\n    const oldConfig = changedProps.get(\"_config\") as\n      | PictureElementsCardConfig\n      | undefined;\n\n    if (\n      !oldHass ||\n      !oldConfig ||\n      oldHass.themes !== this.hass.themes ||\n      oldConfig.theme !== this._config.theme\n    ) {\n      applyThemesOnElement(this, this.hass.themes, this._config.theme);\n    }\n  }\n\n  protected render(): TemplateResult {\n    if (!this.hass || !this._config) {\n      return html``;\n    }\n\n    return html`\n      <ha-card .header=${this._config.title}>\n        <div id=\"root\">\n          <hui-image\n            .hass=${this.hass}\n            .image=${this._config.image}\n            .stateImage=${this._config.state_image}\n            .stateFilter=${this._config.state_filter}\n            .cameraImage=${this._config.camera_image}\n            .cameraView=${this._config.camera_view}\n            .entity=${this._config.entity}\n            .aspectRatio=${this._config.aspect_ratio}\n            .darkModeFilter=${this._config.dark_mode_filter}\n            .darkModeImage=${this._config.dark_mode_image}\n          ></hui-image>\n          ${this._elements}\n        </div>\n      </ha-card>\n    `;\n  }\n\n  static get styles(): CSSResultGroup {\n    return css`\n      #root {\n        position: relative;\n      }\n\n      .element {\n        position: absolute;\n        transform: translate(-50%, -50%);\n      }\n\n      ha-card {\n        overflow: hidden;\n        height: 100%;\n        box-sizing: border-box;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-picture-elements-card\": HuiPictureElementsCard;\n  }\n}\n"],"names":[],"sourceRoot":""}