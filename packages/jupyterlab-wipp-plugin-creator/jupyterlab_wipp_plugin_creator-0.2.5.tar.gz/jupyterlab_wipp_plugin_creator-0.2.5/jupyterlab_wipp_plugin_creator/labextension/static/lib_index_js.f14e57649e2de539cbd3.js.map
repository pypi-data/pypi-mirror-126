{"version":3,"file":"lib_index_js.f14e57649e2de539cbd3.js","mappings":";;;;;;;;;;;;;;;;AAAyC;AACiB;AACnD,+BAA+B,mDAAM;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,yEAAwB;AAClD;AACA;AACA;AACA,gCAAgC,iCAAiC;AACjE;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AC/BO;AACP;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,UAAU;AACrC;AACA;AACA,KAAK;AACL;;;;;;;;;;;;;;;;;;;ACd+C;AACS;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACO,kDAAkD;AACzD;AACA,qBAAqB,+EAA6B;AAClD,uBAAuB,8DAAW;AAClC;AACA;AACA;AACA,yBAAyB,8EAA4B;AACrD;AACA;AACA,kBAAkB,+EAA6B;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,gFAA8B;AAChD;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClCoD;AACM;AACI;AACf;AACK;AACuB;AAChC;AACH;AACxC,qBAAqB,8DAAO;AAC5B;AACA,YAAY,uDAAO;AACnB,CAAC;AACD;AACA;AACA;AACA;AACA,eAAe,wEAAmB,EAAE,8DAAS,EAAE,yDAAQ,EAAE,oEAAgB;AACzE;AACA;AACA;AACA;AACA,6BAA6B,yEAAwB;AACrD,2BAA2B,yEAAwB;AACnD;AACA,SAAS;AACT;AACA,4BAA4B,oDAAc;AAC1C;AACA;AACA;AACA,wCAAwC,WAAW;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,oEAAe;AAC/B;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,iEAAe,MAAM,EAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnDgC;AACD;AACK;AACJ;AACA;AACf;AACgB;AACN;AAC1C,6BAA6B,mDAAM;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,wDAAW;AACrD,0BAA0B,mDAAM;AAChC;AACA;AACA;AACA;AACA;AACA,uBAAuB,mDAAU;AACjC;AACA,4CAA4C,mDAAM;AAClD;AACA;AACA;AACA,2BAA2B,4EAAuB;AAClD;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,oCAAoC,kBAAkB;AACtD;AACA,mDAAmD;AACnD;AACA,wBAAwB,oEAAe;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,+DAAgB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,yBAAyB,gEAAU;AACnC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,oDAAU;AACtB;AACA;AACA,gBAAgB,gEAAU;AAC1B;AACA,8BAA8B,iEAAe;AAC7C,iBAAiB;AACjB,aAAa;AACb;AACA;AACA,gBAAgB,gEAAU;AAC1B;AACA,8BAA8B,iEAAe;AAC7C,iBAAiB;AACjB,aAAa;AACb;AACA;AACA,YAAY,gEAAU;AACtB;AACA,0BAA0B,iEAAe;AACzC,aAAa;AACb;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AClIA,iEAAe,8ZAA8Z","sources":["webpack://jupyterlab_wipp_plugin_creator/./lib/addedFilesWidget.js","webpack://jupyterlab_wipp_plugin_creator/./lib/extensionConstants.js","webpack://jupyterlab_wipp_plugin_creator/./lib/handler.js","webpack://jupyterlab_wipp_plugin_creator/./lib/index.js","webpack://jupyterlab_wipp_plugin_creator/./lib/sidebar.js","webpack://jupyterlab_wipp_plugin_creator/./style/logo.svg"],"sourcesContent":["import { Widget } from '@lumino/widgets';\nimport { ExtensionConstants } from './extensionConstants';\nexport class AddedFilesWidget extends Widget {\n    constructor(state) {\n        super();\n        this._addedFileNames = [];\n        this._state = state;\n        this._addedFileDiv = document.createElement('p');\n        this.node.appendChild(this._addedFileDiv);\n        const button = document.createElement('button');\n        button.className = 'run';\n        button.innerHTML = 'Update list of files';\n        button.onclick = () => this.update();\n        this.node.appendChild(button);\n        this.update();\n    }\n    onUpdateRequest(msg) {\n        this._state.fetch(ExtensionConstants.dbkey).then(response => {\n            this._addedFileNames = response;\n            let text = 'Added Files: <br>';\n            if (this._addedFileNames) {\n                for (let i = 0; i < this._addedFileNames.length; i++) {\n                    text += this._addedFileNames[i] + '<br>';\n                }\n            }\n            this._addedFileDiv.innerHTML = text;\n        });\n    }\n    getValue() {\n        return this._addedFileNames;\n    }\n}\n","export class ExtensionConstants {\n}\nExtensionConstants.dbkey = 'wipp-plugin-creator:data';\nexport function addFilePathToDB(state, filepath) {\n    state.fetch(ExtensionConstants.dbkey).then(response => {\n        const filepaths = response;\n        if (filepaths.indexOf(filepath) === -1) {\n            filepaths.push(filepath);\n        }\n        else {\n            console.log(`${filepath} was already added`);\n        }\n        state.save(ExtensionConstants.dbkey, filepaths);\n    });\n}\n","import { URLExt } from '@jupyterlab/coreutils';\nimport { ServerConnection } from '@jupyterlab/services';\n/**\n * Call the API extension\n *\n * @param endPoint API REST end point for the extension\n * @param init Initial values for the request\n * @returns The response body interpreted as JSON\n */\nexport async function requestAPI(endPoint = '', init = {}) {\n    // Make request to Jupyter API\n    const settings = ServerConnection.makeSettings();\n    const requestUrl = URLExt.join(settings.baseUrl, 'jupyterlab_wipp_plugin_creator', // API Namespace\n    endPoint);\n    let response;\n    try {\n        response = await ServerConnection.makeRequest(requestUrl, init, settings);\n    }\n    catch (error) {\n        throw new ServerConnection.NetworkError(error);\n    }\n    let data = await response.text();\n    if (data.length > 0) {\n        try {\n            data = JSON.parse(data);\n        }\n        catch (error) {\n            console.log('Not a JSON response body.', response);\n        }\n    }\n    if (!response.ok) {\n        throw new ServerConnection.ResponseError(response, data.message || data);\n    }\n    return data;\n}\n","import { ILabShell } from '@jupyterlab/application';\nimport { IDocumentManager } from '@jupyterlab/docmanager';\nimport { IFileBrowserFactory } from '@jupyterlab/filebrowser';\nimport { IStateDB } from '@jupyterlab/statedb';\nimport { LabIcon } from '@jupyterlab/ui-components';\nimport { ExtensionConstants, addFilePathToDB } from './extensionConstants';\nimport { CreatorSidebar } from './sidebar';\nimport logoSvg from '../style/logo.svg';\nconst logoIcon = new LabIcon({\n    name: 'wipp-plugin-builder:logo',\n    svgstr: logoSvg\n});\nconst filepaths = [];\nconst plugin = {\n    id: 'jupyterlab_wipp_plugin_creator:plugin',\n    autoStart: true,\n    requires: [IFileBrowserFactory, ILabShell, IStateDB, IDocumentManager],\n    activate: (app, factory, labShell, state, manager) => {\n        // Initialzie dbkey if not in IStateDB\n        state.list().then(response => {\n            const keys = response.ids;\n            if (keys.indexOf(ExtensionConstants.dbkey) === -1) {\n                state.save(ExtensionConstants.dbkey, filepaths);\n            }\n        });\n        // Create the WIPP sidebar panel\n        const sidebar = new CreatorSidebar(state, manager);\n        sidebar.id = 'wipp-labextension:plugin';\n        sidebar.title.icon = logoIcon;\n        sidebar.title.caption = 'WIPP Plugin Creator';\n        labShell.add(sidebar, 'left', { rank: 200 });\n        // Add context menu command, right click file browser to register marked files to be converted to plugin\n        let filepath = '';\n        const addFileToPluginContextMenuCommandID = 'wipp-plugin-creator-add-context-menu';\n        app.commands.addCommand(addFileToPluginContextMenuCommandID, {\n            label: 'Add to the new WIPP plugin',\n            iconClass: 'jp-MaterialIcon jp-AddIcon',\n            isVisible: () => ['notebook', 'file'].includes(factory.tracker.currentWidget.selectedItems().next().type),\n            execute: () => {\n                filepath = factory.tracker.currentWidget.selectedItems().next().path;\n                addFilePathToDB(state, filepath);\n            }\n        });\n        // Add command to context menu\n        const selectorItem = '.jp-DirListing-item[data-isdir]';\n        app.contextMenu.addItem({\n            command: addFileToPluginContextMenuCommandID,\n            selector: selectorItem\n        });\n    }\n};\nexport default plugin;\n","import { Widget, PanelLayout } from '@lumino/widgets';\nimport { FileDialog } from '@jupyterlab/filebrowser';\nimport { showDialog, Dialog } from '@jupyterlab/apputils';\nimport { SchemaForm } from '@polusai/jupyterlab-rjsf';\nimport { AddedFilesWidget } from './addedFilesWidget';\nimport { requestAPI } from './handler';\nimport { addFilePathToDB } from './extensionConstants';\nimport schemaForm from './WippPluginSchema.json';\nexport class CreatorSidebar extends Widget {\n    /**\n     * Create a new WIPP plugin creator sidebar.\n     */\n    constructor(state, manager) {\n        super();\n        this.addClass('wipp-pluginCreatorSidebar');\n        // Define Widget layout\n        const layout = (this.layout = new PanelLayout());\n        const title = new Widget();\n        const h1 = document.createElement('h1');\n        h1.innerText = 'Create New Plugin';\n        title.node.appendChild(h1);\n        layout.addWidget(title);\n        // Necessary or plugin will not activate\n        const schema = schemaForm;\n        // Create file manager button\n        const chooseFilesButtonWidget = new Widget();\n        const chooseFilesButton = document.createElement('button');\n        chooseFilesButton.className = 'run';\n        chooseFilesButton.onclick = async () => {\n            const dialog = FileDialog.getOpenFiles({\n                manager // IDocumentManager\n            });\n            const result = await dialog;\n            if (result.button.accept) {\n                const files = result.value;\n                let filepath;\n                if (files) {\n                    for (let i = 0; i < files.length; i++) {\n                        // files is a list of json,\n                        // e.g. files[0]: Object { name: \"pyproject.toml\", path: \"pyproject.toml\" ..}\n                        filepath = files[i]['path'];\n                        addFilePathToDB(state, filepath);\n                    }\n                }\n                // log files object on 'Select' of the file manager\n                console.log(files);\n            }\n        };\n        chooseFilesButton.innerText = 'Choose Files';\n        chooseFilesButtonWidget.node.appendChild(chooseFilesButton);\n        layout.addWidget(chooseFilesButtonWidget);\n        this._addFileWidget = new AddedFilesWidget(state);\n        layout.addWidget(this._addFileWidget);\n        const formData = {\n            name: 'My Plugin',\n            title: 'My Plugin',\n            version: '0.1.0',\n            description: '',\n            author: '',\n            institution: '',\n            repository: '',\n            website: '',\n            citation: '',\n            requirements: [''],\n            inputs: [{}],\n            outputs: [{}],\n            baseImage: ''\n        };\n        const uiSchema = {\n            name: {\n                'ui:help': 'Hint: Enter human-readable name'\n            },\n            title: {\n                'ui:help': 'Hint: Enter machine-readable name'\n            },\n            requirements: {\n                'ui:help': `Hint: Enter 3rd party python packages that the plugin requires. Just the package name is fine for its latest version. To specify version: \\r\n          SomeProject == 1.3 \\r\n          SomeProject >=1.2,<2.0 \\r\n          SomeProject~=1.4.2 (~= means compatible, >=1.4.2, ==1.4.X)`\n            },\n            baseImage: {\n                'ui:help': 'Hint: Choose the base image of the WIPP plugin to be created. Leave it as Python if unsure.'\n            }\n        };\n        this._form = new SchemaForm(schema, {\n            formData: formData,\n            uiSchema: uiSchema,\n            onSubmit: (e) => this.submit()\n        });\n        layout.addWidget(this._form);\n    }\n    //Sidebar constructor ends\n    submit() {\n        //Create API request on submit\n        const formValue = this._form.getValue();\n        const request = {\n            formdata: formValue.formData,\n            addedfilepaths: this._addFileWidget.getValue()\n        };\n        if (formValue.errors !== null) {\n            const fullRequest = {\n                method: 'POST',\n                body: JSON.stringify(request)\n            };\n            requestAPI('createplugin', fullRequest)\n                .then(response => {\n                console.log('POST request sent.');\n                showDialog({\n                    body: 'Create Plugin request submitted. Building the plugin...',\n                    buttons: [Dialog.okButton()]\n                });\n            })\n                .catch(() => {\n                console.log('There is an error making POST CreatePlugin API request.');\n                showDialog({\n                    body: 'There is an error making POST CreatePlugin API request.',\n                    buttons: [Dialog.okButton()]\n                });\n            });\n        }\n        else {\n            showDialog({\n                body: 'There is an error with form value. Plugin build request failed.',\n                buttons: [Dialog.okButton()]\n            });\n            console.log('Schema form data returns with an error');\n            console.log(formValue.errors);\n        }\n    }\n}\n","export default \"<svg width=\\\"1792\\\" height=\\\"1792\\\" viewBox=\\\"0 0 1792 1792\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n    <path class=\\\"jp-icon3 jp-icon-selectable\\\" fill=\\\"#616161\\\" d=\\\"M896 1629l640-349v-636l-640 233v752zm-64-865l698-254-698-254-698 254zm832-252v768q0 35-18 65t-49 47l-704 384q-28 16-61 16t-61-16l-704-384q-31-17-49-47t-18-65v-768q0-40 23-73t61-47l704-256q22-8 44-8t44 8l704 256q38 14 61 47t23 73z\\\"/>\\n</svg> \";"],"names":[],"sourceRoot":""}