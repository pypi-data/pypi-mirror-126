---

title: M4 dataset


keywords: fastai
sidebar: home_sidebar

summary: "Download and evaluate the M4 dataset."
description: "Download and evaluate the M4 dataset."
nb_path: "nbs/data_datasets__m4.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/data_datasets__m4.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="M4-meta-information">M4 meta information<a class="anchor-link" href="#M4-meta-information"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Yearly" class="doc_header"><code>class</code> <code>Yearly</code><a href="https://github.com/Nixtla/nixtlats/tree/master/nixtlats/data/datasets/m4.py#L18" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Yearly</code>(<strong><code>seasonality</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>horizon</code></strong>:<code>int</code>=<em><code>6</code></em>, <strong><code>freq</code></strong>:<code>str</code>=<em><code>'Y'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'Yearly'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>23000</code></em>)</p>
</blockquote>
<p>Yearly(seasonality: int = 1, horizon: int = 6, freq: str = 'Y', name: str = 'Yearly', n_ts: int = 23000)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Quarterly" class="doc_header"><code>class</code> <code>Quarterly</code><a href="https://github.com/Nixtla/nixtlats/tree/master/nixtlats/data/datasets/m4.py#L26" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Quarterly</code>(<strong><code>seasonality</code></strong>:<code>int</code>=<em><code>4</code></em>, <strong><code>horizon</code></strong>:<code>int</code>=<em><code>8</code></em>, <strong><code>freq</code></strong>:<code>str</code>=<em><code>'Q'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'Quarterly'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>24000</code></em>)</p>
</blockquote>
<p>Quarterly(seasonality: int = 4, horizon: int = 8, freq: str = 'Q', name: str = 'Quarterly', n_ts: int = 24000)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Monthly" class="doc_header"><code>class</code> <code>Monthly</code><a href="https://github.com/Nixtla/nixtlats/tree/master/nixtlats/data/datasets/m4.py#L34" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Monthly</code>(<strong><code>seasonality</code></strong>:<code>int</code>=<em><code>12</code></em>, <strong><code>horizon</code></strong>:<code>int</code>=<em><code>18</code></em>, <strong><code>freq</code></strong>:<code>str</code>=<em><code>'M'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'Monthly'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>48000</code></em>)</p>
</blockquote>
<p>Monthly(seasonality: int = 12, horizon: int = 18, freq: str = 'M', name: str = 'Monthly', n_ts: int = 48000)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Weekly" class="doc_header"><code>class</code> <code>Weekly</code><a href="https://github.com/Nixtla/nixtlats/tree/master/nixtlats/data/datasets/m4.py#L42" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Weekly</code>(<strong><code>seasonality</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>horizon</code></strong>:<code>int</code>=<em><code>13</code></em>, <strong><code>freq</code></strong>:<code>str</code>=<em><code>'W'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'Weekly'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>359</code></em>)</p>
</blockquote>
<p>Weekly(seasonality: int = 1, horizon: int = 13, freq: str = 'W', name: str = 'Weekly', n_ts: int = 359)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Daily" class="doc_header"><code>class</code> <code>Daily</code><a href="https://github.com/Nixtla/nixtlats/tree/master/nixtlats/data/datasets/m4.py#L50" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Daily</code>(<strong><code>seasonality</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>horizon</code></strong>:<code>int</code>=<em><code>14</code></em>, <strong><code>freq</code></strong>:<code>str</code>=<em><code>'D'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'Daily'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>4227</code></em>)</p>
</blockquote>
<p>Daily(seasonality: int = 1, horizon: int = 14, freq: str = 'D', name: str = 'Daily', n_ts: int = 4227)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Hourly" class="doc_header"><code>class</code> <code>Hourly</code><a href="https://github.com/Nixtla/nixtlats/tree/master/nixtlats/data/datasets/m4.py#L58" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Hourly</code>(<strong><code>seasonality</code></strong>:<code>int</code>=<em><code>24</code></em>, <strong><code>horizon</code></strong>:<code>int</code>=<em><code>48</code></em>, <strong><code>freq</code></strong>:<code>str</code>=<em><code>'H'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'Hourly'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>414</code></em>)</p>
</blockquote>
<p>Hourly(seasonality: int = 24, horizon: int = 48, freq: str = 'H', name: str = 'Hourly', n_ts: int = 414)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Other" class="doc_header"><code>class</code> <code>Other</code><a href="https://github.com/Nixtla/nixtlats/tree/master/nixtlats/data/datasets/m4.py#L67" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Other</code>(<strong><code>seasonality</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>horizon</code></strong>:<code>int</code>=<em><code>8</code></em>, <strong><code>freq</code></strong>:<code>str</code>=<em><code>'D'</code></em>, <strong><code>name</code></strong>:<code>str</code>=<em><code>'Other'</code></em>, <strong><code>n_ts</code></strong>:<code>int</code>=<em><code>5000</code></em>, <strong><code>included_groups</code></strong>:<code>Tuple</code>=<em><code>('Weekly', 'Daily', 'Hourly')</code></em>)</p>
</blockquote>
<p>Other(seasonality: int = 1, horizon: int = 8, freq: str = 'D', name: str = 'Other', n_ts: int = 5000, included_groups: Tuple = ('Weekly', 'Daily', 'Hourly'))</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Download-data-class">Download data class<a class="anchor-link" href="#Download-data-class"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="M4" class="doc_header"><code>class</code> <code>M4</code><a href="https://github.com/Nixtla/nixtlats/tree/master/nixtlats/data/datasets/m4.py#L81" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>M4</code>(<strong><code>source_url</code></strong>:<code>str</code>=<em><code>'https://raw.githubusercontent.com/Mcompetitions/M4-methods/master/Dataset/'</code></em>, <strong><code>naive2_forecast_url</code></strong>:<code>str</code>=<em><code>'https://github.com/Nixtla/m4-forecasts/raw/master/forecasts/submission-Naive2.zip'</code></em>)</p>
</blockquote>
<p>M4(source_url: str = '<a href="https://raw.githubusercontent.com/Mcompetitions/M4-methods/master/Dataset/">https://raw.githubusercontent.com/Mcompetitions/M4-methods/master/Dataset/</a>', naive2_forecast_url: str = '<a href="https://github.com/Nixtla/m4-forecasts/raw/master/forecasts/submission-Naive2.zip">https://github.com/Nixtla/m4-forecasts/raw/master/forecasts/submission-Naive2.zip</a>')</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">M4Info</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">group</span> <span class="o">!=</span> <span class="s1">&#39;Hourly&#39;</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">M4</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">)</span>
    <span class="n">n_series</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">unique_id</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>

    <span class="n">display_str</span>  <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Group: </span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s1"> &#39;</span>
    <span class="n">display_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;n_series: </span><span class="si">{</span><span class="n">n_series</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">display_str</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Group: Hourly n_series: 414
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Evaluation-class">Evaluation class<a class="anchor-link" href="#Evaluation-class"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="M4Evaluation" class="doc_header"><code>class</code> <code>M4Evaluation</code><a href="https://github.com/Nixtla/nixtlats/tree/master/nixtlats/data/datasets/m4.py#L173" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>M4Evaluation</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="URL-based-evaluation">URL-based evaluation<a class="anchor-link" href="#URL-based-evaluation"> </a></h3><p>The method <code>evaluate</code> from the class <a href="/nixtlats/data_datasets__m4.html#M4Evaluation"><code>M4Evaluation</code></a> can receive a url of a <a href="https://github.com/Mcompetitions/M4-methods/tree/master/Point%20Forecasts">benchmark uploaded to the M4 competiton</a>.</p>
<p>The results compared to the on-the-fly evaluation were obtained from the <a href="https://github.com/Mcompetitions/M4-methods/blob/master/Evaluation%20and%20Ranks.xlsx">official evaluation</a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">esrnn_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/Nixtla/m4-forecasts/raw/master/forecasts/submission-118.zip&#39;</span>
<span class="n">esrnn_evaluation</span> <span class="o">=</span> <span class="n">M4Evaluation</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;Hourly&#39;</span><span class="p">,</span> <span class="n">esrnn_url</span><span class="p">)</span>
<span class="c1"># Test of the same evaluation as the original one</span>
<span class="n">test_close</span><span class="p">(</span><span class="n">esrnn_evaluation</span><span class="p">[</span><span class="s1">&#39;SMAPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mf">9.328</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">test_close</span><span class="p">(</span><span class="n">esrnn_evaluation</span><span class="p">[</span><span class="s1">&#39;MASE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mf">0.893</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">test_close</span><span class="p">(</span><span class="n">esrnn_evaluation</span><span class="p">[</span><span class="s1">&#39;OWA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mf">0.440</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">esrnn_evaluation</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SMAPE</th>
      <th>MASE</th>
      <th>OWA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hourly</th>
      <td>9.328443</td>
      <td>0.893046</td>
      <td>0.440163</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numpy-based-evaluation">Numpy-based evaluation<a class="anchor-link" href="#Numpy-based-evaluation"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Also the method <code>evaluate</code> can recevie a numpy array of forecasts.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fforma_url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/Nixtla/m4-forecasts/raw/master/forecasts/submission-245.zip&#39;</span>
<span class="n">fforma_forecasts</span> <span class="o">=</span> <span class="n">M4Evaluation</span><span class="o">.</span><span class="n">load_benchmark</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;Hourly&#39;</span><span class="p">,</span> <span class="n">fforma_url</span><span class="p">)</span>
<span class="n">fforma_evaluation</span> <span class="o">=</span> <span class="n">M4Evaluation</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;Hourly&#39;</span><span class="p">,</span> <span class="n">fforma_forecasts</span><span class="p">)</span>
<span class="c1"># Test of the same evaluation as the original one</span>
<span class="n">test_close</span><span class="p">(</span><span class="n">fforma_evaluation</span><span class="p">[</span><span class="s1">&#39;SMAPE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mf">11.506</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">test_close</span><span class="p">(</span><span class="n">fforma_evaluation</span><span class="p">[</span><span class="s1">&#39;MASE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mf">0.819</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">test_close</span><span class="p">(</span><span class="n">fforma_evaluation</span><span class="p">[</span><span class="s1">&#39;OWA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mf">0.484</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">fforma_evaluation</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SMAPE</th>
      <th>MASE</th>
      <th>OWA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hourly</th>
      <td>11.505702</td>
      <td>0.818598</td>
      <td>0.483841</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

